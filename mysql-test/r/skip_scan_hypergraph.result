# Note: A lot of these tests changed with the new cost model.
# Following the cost model patches we can no longer trust
# that the chosen plans matches the intended plan for these tests.
#
# TODO(tlchrist): Find a way to make these tests stable
# and maintainable under changes to the cost model and statistics.
CREATE TABLE t (a INT, b INT, c INT, d INT, e INT, KEY b(a, b, c, d)) ENGINE=innodb;
# Since ANALYZE TABLE only reads a subset of the data, the statistics for
# table t depends on the row order. And since the INSERT INTO ... SELECT
# may be executed using different execution plans, we've added ORDER BY
# to ensure that we rows has the same order every time. If not, the
# estimated number of rows in EXPLAIN may change on different platforms.
ANALYZE TABLE t;
Table	Op	Msg_type	Msg_text
test.t	analyze	status	OK
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT b, c from t where b = 2 and c < 3;
EXPLAIN
-> Filter: (t.c < 3)  (rows=3.77)
    -> Covering index skip scan on t using b over b = 2  (rows=16)

FLUSH STATUS;
SELECT b, c from t where b = 2 and c < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT b, c from t where b = 2 and c < 3;
EXPLAIN
-> Filter: ((t.b = 2) and (t.c < 3))  (rows=3.77)
    -> Covering index scan on t using b  (rows=160)

FLUSH STATUS;
SELECT b, c from t where b = 2 and c < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ b, c FROM t WHERE b = 2 and c < 3;
EXPLAIN
-> Filter: (t.c < 3)  (rows=3.77)
    -> Covering index skip scan on t using b over b = 2  (rows=16)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ b, c FROM t WHERE b = 2 and c < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT b, c from t where b = 1 and c > 4;
EXPLAIN
-> Filter: (t.c > 4)  (rows=3.77)
    -> Covering index skip scan on t using b over b = 1  (rows=16)

FLUSH STATUS;
SELECT b, c from t where b = 1 and c > 4;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT b, c from t where b = 1 and c > 4;
EXPLAIN
-> Filter: ((t.b = 1) and (t.c > 4))  (rows=3.77)
    -> Covering index scan on t using b  (rows=160)

FLUSH STATUS;
SELECT b, c from t where b = 1 and c > 4;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ b, c from t where b = 1 and c > 4;
EXPLAIN
-> Filter: (t.c > 4)  (rows=3.77)
    -> Covering index skip scan on t using b over b = 1  (rows=16)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ b, c from t where b = 1 and c > 4;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a = 5 AND d <= 3;
EXPLAIN
-> Filter: (t.d <= 3)  (rows=0.333)
    -> Covering index range scan on t using b over (a = 5)  (rows=1)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a = 5 AND d <= 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a = 5 AND d <= 3;
EXPLAIN
-> Filter: (t.d <= 3)  (rows=0.333)
    -> Covering index range scan on t using b over (a = 5)  (rows=1)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a = 5 AND d <= 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a = 5 AND d <= 3;
EXPLAIN
-> Covering index skip scan on t using b over a = 5, NULL < d <= 3  (rows=0.333)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a = 5 AND d <= 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a = 5 AND d >= 98;
EXPLAIN
-> Filter: (t.d >= 98)  (rows=0.333)
    -> Covering index range scan on t using b over (a = 5)  (rows=1)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a = 5 AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a = 5 AND d >= 98;
EXPLAIN
-> Filter: (t.d >= 98)  (rows=0.333)
    -> Covering index range scan on t using b over (a = 5)  (rows=1)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a = 5 AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a = 5 AND d >= 98;
EXPLAIN
-> Covering index skip scan on t using b over a = 5, 98 <= d  (rows=0.333)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a = 5 AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a IN (1, 5) AND d >= 98;
EXPLAIN
-> Filter: (t.d >= 98)  (rows=27)
    -> Covering index range scan on t using b over (a = 1) OR (a = 5)  (rows=81)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a IN (1, 5) AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	2
Handler_read_last	0
Handler_read_next	80
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a IN (1, 5) AND d >= 98;
EXPLAIN
-> Filter: (t.d >= 98)  (rows=27)
    -> Covering index range scan on t using b over (a = 1) OR (a = 5)  (rows=81)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a IN (1, 5) AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	2
Handler_read_last	0
Handler_read_next	80
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a IN (1, 5) AND d >= 98;
EXPLAIN
-> Covering index skip scan on t using b over a IN (1, 5), 98 <= d  (rows=27)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a IN (1, 5) AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	82
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a IN (1, 3, 5) AND d >= 98;
EXPLAIN
-> Filter: (t.d >= 98)  (rows=27.3)
    -> Covering index range scan on t using b over (a = 1) OR (a = 3) OR (a = 5)  (rows=82)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a IN (1, 3, 5) AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	3
Handler_read_last	0
Handler_read_next	80
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a IN (1, 3, 5) AND d >= 98;
EXPLAIN
-> Filter: (t.d >= 98)  (rows=27.3)
    -> Covering index range scan on t using b over (a = 1) OR (a = 3) OR (a = 5)  (rows=82)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a IN (1, 3, 5) AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	3
Handler_read_last	0
Handler_read_next	80
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a IN (1, 3, 5) AND d >= 98;
EXPLAIN
-> Covering index skip scan on t using b over a IN (1, 3, 5), 98 <= d  (rows=27.3)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a IN (1, 3, 5) AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	82
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a IN (1, 5) AND b IN (1, 2) AND d >= 98;
EXPLAIN
-> Filter: (t.d >= 98)  (rows=6)
    -> Covering index range scan on t using b over (a = 1 AND b = 1) OR (a = 1 AND b = 2) OR (2 more)  (rows=18)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a IN (1, 5) AND b IN (1, 2) AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	4
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a IN (1, 5) AND b IN (1, 2) AND d >= 98;
EXPLAIN
-> Filter: (t.d >= 98)  (rows=6)
    -> Covering index range scan on t using b over (a = 1 AND b = 1) OR (a = 1 AND b = 2) OR (2 more)  (rows=18)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a IN (1, 5) AND b IN (1, 2) AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	4
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a IN (1, 5) AND b IN (1, 2) AND d >= 98;
EXPLAIN
-> Covering index skip scan on t using b over a IN (1, 5), b IN (1, 2), 98 <= d  (rows=6)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a IN (1, 5) AND b IN (1, 2) AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	19
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a IN (1, 2, 3, 4, 5) AND b IN (1, 2, 3) AND d >= 98;
EXPLAIN
-> Filter: (t.d >= 98)  (rows=19)
    -> Covering index range scan on t using b over (a = 1 AND b = 1) OR (a = 1 AND b = 2) OR (13 more)  (rows=57)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a IN (1, 2, 3, 4, 5) AND b IN (1, 2, 3) AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	15
Handler_read_last	0
Handler_read_next	48
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a IN (1, 2, 3, 4, 5) AND b IN (1, 2, 3) AND d >= 98;
EXPLAIN
-> Filter: (t.d >= 98)  (rows=19)
    -> Covering index range scan on t using b over (a = 1 AND b = 1) OR (a = 1 AND b = 2) OR (13 more)  (rows=57)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a IN (1, 2, 3, 4, 5) AND b IN (1, 2, 3) AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	15
Handler_read_last	0
Handler_read_next	48
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a IN (1, 2, 3, 4, 5) AND b IN (1, 2, 3) AND d >= 98;
EXPLAIN
-> Covering index skip scan on t using b over a IN (1, 2, (3 more)), b IN (1, 2, 3), 98 <= d  (rows=19)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a IN (1, 2, 3, 4, 5) AND b IN (1, 2, 3) AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	55
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a = 5 AND b = 2 AND d >= 98;
EXPLAIN
-> Filter: (t.d >= 98)  (rows=0.333)
    -> Covering index range scan on t using b over (a = 5 AND b = 2)  (rows=1)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a = 5 AND b = 2 AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a = 5 AND b = 2 AND d >= 98;
EXPLAIN
-> Filter: (t.d >= 98)  (rows=0.333)
    -> Covering index range scan on t using b over (a = 5 AND b = 2)  (rows=1)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a = 5 AND b = 2 AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a = 5 AND b = 2 AND d >= 98;
EXPLAIN
-> Covering index skip scan on t using b over a = 5, b = 2, 98 <= d  (rows=0.333)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a = 5 AND b = 2 AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT b, c FROM t WHERE b BETWEEN 1 AND 2 AND c > 4;
EXPLAIN
-> Filter: ((t.b between 1 and 2) and (t.c > 4))  (rows=5.92)
    -> Covering index skip scan on t using b over 1 <= b <= 2  (rows=17)

FLUSH STATUS;
SELECT b, c FROM t WHERE b BETWEEN 1 AND 2 AND c > 4;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	32
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT b, c FROM t WHERE b BETWEEN 1 AND 2 AND c > 4;
EXPLAIN
-> Filter: ((t.b between 1 and 2) and (t.c > 4))  (rows=5.92)
    -> Covering index scan on t using b  (rows=160)

FLUSH STATUS;
SELECT b, c FROM t WHERE b BETWEEN 1 AND 2 AND c > 4;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ b, c FROM t WHERE b BETWEEN 1 AND 2 AND c > 4;
EXPLAIN
-> Filter: ((t.b between 1 and 2) and (t.c > 4))  (rows=5.92)
    -> Covering index skip scan on t using b over 1 <= b <= 2  (rows=17)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ b, c FROM t WHERE b BETWEEN 1 AND 2 AND c > 4;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	32
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE a = 5 AND d < 3;
EXPLAIN
-> Filter: (t.d < 3)  (rows=0.333)
    -> Covering index range scan on t using b over (a = 5)  (rows=1)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE a = 5 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE a = 5 AND d < 3;
EXPLAIN
-> Filter: (t.d < 3)  (rows=0.333)
    -> Covering index range scan on t using b over (a = 5)  (rows=1)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE a = 5 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE a = 5 AND d < 3;
EXPLAIN
-> Covering index skip scan on t using b over a = 5, NULL < d < 3  (rows=0.333)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE a = 5 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a = b AND d >= 98;
EXPLAIN
-> Filter: ((t.d >= 98) and (t.a = t.b))  (rows=26.7)
    -> Covering index scan on t using b  (rows=160)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a = b AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a = b AND d >= 98;
EXPLAIN
-> Filter: ((t.d >= 98) and (t.a = t.b))  (rows=26.7)
    -> Covering index scan on t using b  (rows=160)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a = b AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a = b AND d >= 98;
EXPLAIN
-> Filter: (t.a = t.b)  (rows=26.7)
    -> Covering index skip scan on t using b over 98 <= d  (rows=160)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a = b AND d >= 98;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	161
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE a = 5 AND c > 10 AND d < 3;
EXPLAIN
-> Filter: ((t.c > 10) and (t.d < 3))  (rows=0.111)
    -> Covering index range scan on t using b over (a = 5)  (rows=1)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE a = 5 AND c > 10 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE a = 5 AND c > 10 AND d < 3;
EXPLAIN
-> Filter: ((t.c > 10) and (t.d < 3))  (rows=0.111)
    -> Covering index range scan on t using b over (a = 5)  (rows=1)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE a = 5 AND c > 10 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE a = 5 AND c > 10 AND d < 3;
EXPLAIN
-> Filter: (t.d < 3)  (rows=0.111)
    -> Covering index skip scan on t using b over a = 5, 10 < c  (rows=1)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE a = 5 AND c > 10 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE b = 5 AND c > 10 AND d < 3 ORDER BY d, c;
EXPLAIN
-> Sort: t.d, t.c  (rows=1.26)
    -> Filter: ((t.c > 10) and (t.d < 3))  (rows=1.26)
        -> Covering index skip scan on t using b over b = 5  (rows=16)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE b = 5 AND c > 10 AND d < 3 ORDER BY d, c;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE b = 5 AND c > 10 AND d < 3 ORDER BY d, c;
EXPLAIN
-> Sort: t.d, t.c  (rows=1.26)
    -> Filter: ((t.b = 5) and (t.c > 10) and (t.d < 3))  (rows=1.26)
        -> Covering index scan on t using b  (rows=160)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE b = 5 AND c > 10 AND d < 3 ORDER BY d, c;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE b = 5 AND c > 10 AND d < 3 ORDER BY d, c;
EXPLAIN
-> Sort: t.d, t.c  (rows=1.26)
    -> Filter: ((t.c > 10) and (t.d < 3))  (rows=1.26)
        -> Covering index skip scan on t using b over b = 5  (rows=16)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE b = 5 AND c > 10 AND d < 3 ORDER BY d, c;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE  b = 5 AND c > 1 AND d < 3 ORDER BY d, c * -1;
EXPLAIN
-> Sort: t.d, (t.c * -(1))  (rows=1.26)
    -> Filter: ((t.c > 1) and (t.d < 3))  (rows=1.26)
        -> Covering index skip scan on t using b over b = 5  (rows=16)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE  b = 5 AND c > 1 AND d < 3 ORDER BY d, c * -1;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE  b = 5 AND c > 1 AND d < 3 ORDER BY d, c * -1;
EXPLAIN
-> Sort: t.d, (t.c * -(1))  (rows=1.26)
    -> Filter: ((t.b = 5) and (t.c > 1) and (t.d < 3))  (rows=1.26)
        -> Covering index scan on t using b  (rows=160)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE  b = 5 AND c > 1 AND d < 3 ORDER BY d, c * -1;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE b = 5 AND c > 1 AND d < 3 ORDER BY d, c * -1;
EXPLAIN
-> Sort: t.d, (t.c * -(1))  (rows=1.26)
    -> Filter: ((t.c > 1) and (t.d < 3))  (rows=1.26)
        -> Covering index skip scan on t using b over b = 5  (rows=16)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE b = 5 AND c > 1 AND d < 3 ORDER BY d, c * -1;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT e FROM t WHERE a = 5 AND d <= 3;
EXPLAIN
-> Filter: (t.d <= 3)  (rows=0.333)
    -> Index range scan on t using b over (a = 5)  (rows=1)

FLUSH STATUS;
SELECT e FROM t WHERE a = 5 AND d <= 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT e FROM t WHERE a = 5 AND d <= 3;
EXPLAIN
-> Filter: (t.d <= 3)  (rows=0.333)
    -> Index range scan on t using b over (a = 5)  (rows=1)

FLUSH STATUS;
SELECT e FROM t WHERE a = 5 AND d <= 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ e FROM t WHERE a = 5 AND d <= 3;
EXPLAIN
-> Filter: (t.d <= 3)  (rows=0.333)
    -> Index range scan on t using b over (a = 5)  (rows=1)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ e FROM t WHERE a = 5 AND d <= 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE a = 5 AND c > 10 AND d < 3 ORDER BY d, c, e;
EXPLAIN
-> Sort: t.d, t.c, t.e  (rows=0.111)
    -> Filter: ((t.c > 10) and (t.d < 3))  (rows=0.111)
        -> Index range scan on t using b over (a = 5)  (rows=1)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE a = 5 AND c > 10 AND d < 3 ORDER BY d, c, e;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE a = 5 AND c > 10 AND d < 3 ORDER BY d, c, e;
EXPLAIN
-> Sort: t.d, t.c, t.e  (rows=0.111)
    -> Filter: ((t.c > 10) and (t.d < 3))  (rows=0.111)
        -> Index range scan on t using b over (a = 5)  (rows=1)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE a = 5 AND c > 10 AND d < 3 ORDER BY d, c, e;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE a = 5 AND c > 10 AND d < 3 ORDER BY d, c, e;
EXPLAIN
-> Sort: t.d, t.c, t.e  (rows=0.111)
    -> Filter: ((t.c > 10) and (t.d < 3))  (rows=0.111)
        -> Index range scan on t using b over (a = 5)  (rows=1)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE a = 5 AND c > 10 AND d < 3 ORDER BY d, c, e;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT count(a), count(b), count(c)  FROM t WHERE b = 5 AND c > 10 AND d < 3;
EXPLAIN
-> Aggregate: count(t.a), count(t.b), count(t.c)  (rows=1)
    -> Filter: ((t.c > 10) and (t.d < 3))  (rows=1.26)
        -> Covering index skip scan on t using b over b = 5  (rows=16)

FLUSH STATUS;
SELECT count(a), count(b), count(c)  FROM t WHERE b = 5 AND c > 10 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT count(a), count(b), count(c)  FROM t WHERE b = 5 AND c > 10 AND d < 3;
EXPLAIN
-> Aggregate: count(t.a), count(t.b), count(t.c)  (rows=1)
    -> Filter: ((t.b = 5) and (t.c > 10) and (t.d < 3))  (rows=1.26)
        -> Covering index scan on t using b  (rows=160)

FLUSH STATUS;
SELECT count(a), count(b), count(c)  FROM t WHERE b = 5 AND c > 10 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ count(a), count(b), count(c) FROM t WHERE a = 5 AND c > 10 AND d < 3;
EXPLAIN
-> Aggregate: count(t.a), count(t.b), count(t.c)  (rows=1)
    -> Filter: (t.d < 3)  (rows=0.111)
        -> Covering index skip scan on t using b over a = 5, 10 < c  (rows=1)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ count(a), count(b), count(c) FROM t WHERE a = 5 AND c > 10 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT min(a), max(b), min(c)  FROM t WHERE b = 5 AND c > 10 AND d < 3;
EXPLAIN
-> Aggregate: min(t.a), max(t.b), min(t.c)  (rows=1)
    -> Filter: ((t.c > 10) and (t.d < 3))  (rows=1.26)
        -> Covering index skip scan on t using b over b = 5  (rows=16)

FLUSH STATUS;
SELECT min(a), max(b), min(c)  FROM t WHERE b = 5 AND c > 10 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT min(a), max(b), min(c)  FROM t WHERE b = 5 AND c > 10 AND d < 3;
EXPLAIN
-> Aggregate: min(t.a), max(t.b), min(t.c)  (rows=1)
    -> Filter: ((t.b = 5) and (t.c > 10) and (t.d < 3))  (rows=1.26)
        -> Covering index scan on t using b  (rows=160)

FLUSH STATUS;
SELECT min(a), max(b), min(c)  FROM t WHERE b = 5 AND c > 10 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ min(a), max(b), min(c) FROM t WHERE a = 5 AND c > 10 AND d < 3;
EXPLAIN
-> Aggregate: min(t.a), max(t.b), min(t.c)  (rows=1)
    -> Filter: (t.d < 3)  (rows=0.111)
        -> Covering index skip scan on t using b over a = 5, 10 < c  (rows=1)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ min(a), max(b), min(c) FROM t WHERE a = 5 AND c > 10 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT sum(a), sum(b), sum(c)  FROM t WHERE b = 5 AND c > 10 AND d < 3;
EXPLAIN
-> Aggregate: sum(t.a), sum(t.b), sum(t.c)  (rows=1)
    -> Filter: ((t.c > 10) and (t.d < 3))  (rows=1.26)
        -> Covering index skip scan on t using b over b = 5  (rows=16)

FLUSH STATUS;
SELECT sum(a), sum(b), sum(c)  FROM t WHERE b = 5 AND c > 10 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT sum(a), sum(b), sum(c)  FROM t WHERE b = 5 AND c > 10 AND d < 3;
EXPLAIN
-> Aggregate: sum(t.a), sum(t.b), sum(t.c)  (rows=1)
    -> Filter: ((t.b = 5) and (t.c > 10) and (t.d < 3))  (rows=1.26)
        -> Covering index scan on t using b  (rows=160)

FLUSH STATUS;
SELECT sum(a), sum(b), sum(c)  FROM t WHERE b = 5 AND c > 10 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ sum(a), avg(b), sum(c) FROM t WHERE a = 5 AND c > 10 AND d < 3;
EXPLAIN
-> Aggregate: sum(t.a), avg(t.b), sum(t.c)  (rows=1)
    -> Filter: (t.d < 3)  (rows=0.111)
        -> Covering index skip scan on t using b over a = 5, 10 < c  (rows=1)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ sum(a), avg(b), sum(c) FROM t WHERE a = 5 AND c > 10 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	1
Handler_read_last	0
Handler_read_next	0
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT count(*) FROM t WHERE d < 2;
EXPLAIN
-> Aggregate: count(0)  (rows=1)
    -> Filter: (t.d < 2)  (rows=53.3)
        -> Covering index scan on t using b  (rows=160)

FLUSH STATUS;
SELECT count(*) FROM t WHERE d < 2;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT count(*) FROM t WHERE d < 2;
EXPLAIN
-> Aggregate: count(0)  (rows=1)
    -> Filter: (t.d < 2)  (rows=53.3)
        -> Covering index scan on t using b  (rows=160)

FLUSH STATUS;
SELECT count(*) FROM t WHERE d < 2;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ count(*) FROM t WHERE  b = 1 AND d < 2;
EXPLAIN
-> Aggregate: count(0)  (rows=1)
    -> Filter: (t.d < 2)  (rows=3.77)
        -> Covering index skip scan on t using b over b = 1  (rows=16)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ count(*) FROM t WHERE  b = 1 AND d < 2;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
Testing DESC index with skip scan.
ALTER TABLE t DROP KEY b;
ALTER TABLE t ADD KEY(a DESC, b, c DESC, d);
ANALYZE TABLE t;
Table	Op	Msg_type	Msg_text
test.t	analyze	status	OK
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE b = 2 AND c > 3 AND d < 3;
EXPLAIN
-> Filter: ((t.c > 3) and (t.d < 3))  (rows=1.26)
    -> Covering index skip scan on t using a over b = 2  (rows=16)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE b = 2 AND c > 3 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE b = 2 AND c > 3 AND d < 3;
EXPLAIN
-> Filter: ((t.b = 2) and (t.c > 3) and (t.d < 3))  (rows=1.26)
    -> Covering index scan on t using a  (rows=160)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE b = 2 AND c > 3 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE b = 2 AND c > 3 AND d < 3;
EXPLAIN
-> Filter: ((t.c > 3) and (t.d < 3))  (rows=1.26)
    -> Covering index skip scan on t using a over b = 2  (rows=16)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE b = 2 AND c > 3 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE b = 2 AND c < 3 AND d < 3;
EXPLAIN
-> Filter: ((t.c < 3) and (t.d < 3))  (rows=1.26)
    -> Covering index skip scan on t using a over b = 2  (rows=16)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE b = 2 AND c < 3 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE b = 2 AND c < 3 AND d < 3;
EXPLAIN
-> Filter: ((t.b = 2) and (t.c < 3) and (t.d < 3))  (rows=1.26)
    -> Covering index scan on t using a  (rows=160)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE b = 2 AND c < 3 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE b = 2 AND c < 3 AND d < 3;
EXPLAIN
-> Filter: ((t.c < 3) and (t.d < 3))  (rows=1.26)
    -> Covering index skip scan on t using a over b = 2  (rows=16)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE b = 2 AND c < 3 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE b = 2 AND c = 3 AND d < 3;
EXPLAIN
-> Filter: ((t.c = 3) and (t.d < 3))  (rows=0.211)
    -> Covering index skip scan on t using a over b = 2  (rows=16)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE b = 2 AND c = 3 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE b = 2 AND c = 3 AND d < 3;
EXPLAIN
-> Filter: ((t.c = 3) and (t.b = 2) and (t.d < 3))  (rows=0.211)
    -> Covering index scan on t using a  (rows=160)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE b = 2 AND c = 3 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE b = 2 AND c = 3 AND d < 3;
EXPLAIN
-> Filter: ((t.c = 3) and (t.d < 3))  (rows=0.211)
    -> Covering index skip scan on t using a over b = 2  (rows=16)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE b = 2 AND c = 3 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE b = 2 AND c BETWEEN 3 AND 5 AND d < 3;
EXPLAIN
-> Filter: ((t.b = 2) and (t.c between 3 and 5) and (t.d < 3))  (rows=0.419)
    -> Covering index skip scan on t using a over b = 2  (rows=16)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE b = 2 AND c BETWEEN 3 AND 5 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE b = 2 AND c BETWEEN 3 AND 5 AND d < 3;
EXPLAIN
-> Filter: ((t.b = 2) and (t.c between 3 and 5) and (t.d < 3))  (rows=0.419)
    -> Covering index scan on t using a  (rows=160)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE b = 2 AND c BETWEEN 3 AND 5 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE b = 2 AND c BETWEEN 3 AND 5 AND d < 3;
EXPLAIN
-> Filter: ((t.b = 2) and (t.c between 3 and 5) and (t.d < 3))  (rows=0.419)
    -> Covering index skip scan on t using a over b = 2  (rows=16)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE b = 2 AND c BETWEEN 3 AND 5 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE b BETWEEN 3 AND 5 AND d < 3;
EXPLAIN
-> Filter: ((t.b between 3 and 5) and (t.d < 3))  (rows=5.92)
    -> Covering index skip scan on t using a over 3 <= b <= 5  (rows=17)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE b BETWEEN 3 AND 5 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	48
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE b BETWEEN 3 AND 5 AND d < 3;
EXPLAIN
-> Filter: ((t.b between 3 and 5) and (t.d < 3))  (rows=5.92)
    -> Covering index scan on t using a  (rows=160)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE b BETWEEN 3 AND 5 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE b BETWEEN 3 AND 5 AND d < 3;
EXPLAIN
-> Filter: ((t.b between 3 and 5) and (t.d < 3))  (rows=5.92)
    -> Covering index skip scan on t using a over 3 <= b <= 5  (rows=17)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE b BETWEEN 3 AND 5 AND d < 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	48
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE b = 3;
EXPLAIN
-> Covering index skip scan on t using a over b = 3  (rows=11.3)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE b = 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT b, c, d FROM t WHERE b = 3;
EXPLAIN
-> Filter: (t.b = 3)  (rows=11.3)
    -> Covering index scan on t using a  (rows=160)

FLUSH STATUS;
SELECT b, c, d FROM t WHERE b = 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE b = 3;
EXPLAIN
-> Covering index skip scan on t using a over b = 3  (rows=11.3)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ b, c, d FROM t WHERE b = 3;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE b = 1 AND c IN (1, 3, 5) AND d >= 5;
EXPLAIN
-> Filter: ((t.c in (1,3,5)) and (t.d >= 5))  (rows=1.13)
    -> Covering index skip scan on t using a over b = 1  (rows=16)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE b = 1 AND c IN (1, 3, 5) AND d >= 5;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE b = 1 AND c IN (1, 3, 5) AND d >= 5;
EXPLAIN
-> Filter: ((t.b = 1) and (t.c in (1,3,5)) and (t.d >= 5))  (rows=1.13)
    -> Covering index scan on t using a  (rows=160)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE b = 1 AND c IN (1, 3, 5) AND d >= 5;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	1
Handler_read_last	0
Handler_read_next	160
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE b = 1 AND c IN (1, 3, 5) AND d >= 5;
EXPLAIN
-> Filter: ((t.c in (1,3,5)) and (t.d >= 5))  (rows=1.13)
    -> Covering index skip scan on t using a over b = 1  (rows=16)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE b = 1 AND c IN (1, 3, 5) AND d >= 5;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	1
Handler_read_key	5
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a IN (1, 5, 3) AND b IN (1, 2) AND d >= 5;
EXPLAIN
-> Filter: (t.d >= 5)  (rows=6.67)
    -> Covering index range scan on t using a over (a = 5 AND b = 1) OR (a = 5 AND b = 2) OR (4 more)  (rows=20)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a IN (1, 5, 3) AND b IN (1, 2) AND d >= 5;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	6
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t WHERE a IN (1, 5, 3) AND b IN (1, 2) AND d >= 5;
EXPLAIN
-> Filter: (t.d >= 5)  (rows=6.67)
    -> Covering index range scan on t using a over (a = 5 AND b = 1) OR (a = 5 AND b = 2) OR (4 more)  (rows=20)

FLUSH STATUS;
SELECT a, b, c, d FROM t WHERE a IN (1, 5, 3) AND b IN (1, 2) AND d >= 5;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	6
Handler_read_last	0
Handler_read_next	16
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a IN (1, 5, 3) AND b in (1, 2) AND d >= 5;
EXPLAIN
-> Covering index skip scan on t using a over a IN (5, 3, 1), b IN (1, 2), 5 <= d  (rows=6.67)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t) */ a, b, c, d FROM t WHERE a IN (1, 5, 3) AND b in (1, 2) AND d >= 5;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	22
Handler_read_last	0
Handler_read_next	14
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = default;
DROP TABLE t;
Testing DESC index with skip scan and NULL range.
CREATE TABLE t1 (a INT, b INT, c INT, d INT, e INT,
KEY k1(a DESC, b, c DESC, d, e DESC));
INSERT INTO t1 VALUES
(NULL, 1, 1, 3, 4), (NULL, 2, 1, 4, 5),
(1, 2, 1, 3, 4), (2, 2, 1, 4, 5),
(5, 2, 3, 3, 4), (2, 2, 1, 4, 11),
(8, 2, 1, 3, 4), (7, 2, 1, 4, 9);
INSERT INTO t1 SELECT * FROM t1;
INSERT INTO t1 SELECT * FROM t1;
INSERT INTO t1 SELECT * FROM t1;
ANALYZE TABLE t1;
Table	Op	Msg_type	Msg_text
test.t1	analyze	status	OK
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t1 WHERE (a IN (1, 5) or a IS NULL) AND b in (1, 2) AND d BETWEEN 2 AND 5;
EXPLAIN
-> Filter: (t1.d between 2 and 5)  (rows=3.78)
    -> Covering index range scan on t1 using k1 over (a = 5 AND b = 1) OR (a = 5 AND b = 2) OR (4 more)  (rows=34)

FLUSH STATUS;
SELECT a, b, c, d FROM t1 WHERE (a IN (1, 5) or a IS NULL) AND b in (1, 2) AND d BETWEEN 2 AND 5;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	6
Handler_read_last	0
Handler_read_next	32
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t1 WHERE (a IN (1, 5) or a IS NULL) AND b in (1, 2) AND d BETWEEN 2 AND 5;
EXPLAIN
-> Filter: (t1.d between 2 and 5)  (rows=3.78)
    -> Covering index range scan on t1 using k1 over (a = 5 AND b = 1) OR (a = 5 AND b = 2) OR (4 more)  (rows=34)

FLUSH STATUS;
SELECT a, b, c, d FROM t1 WHERE (a IN (1, 5) or a IS NULL) AND b in (1, 2) AND d BETWEEN 2 AND 5;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	6
Handler_read_last	0
Handler_read_next	32
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t1) */ a, b, c, d FROM t1 WHERE (a IN (1, 5) or a IS NULL) AND b in (1, 2) AND d BETWEEN 2 AND 5;
EXPLAIN
-> Filter: ((t1.d between 2 and 5) and (t1.b in (1,2)) and ((t1.a in (1,5)) or (t1.a is null)))  (rows=3.78)
    -> Covering index skip scan on t1 using k1 over a IN (5, 1, NULL), b IN (1, 2), 2 <= d <= 5  (rows=34)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t1) */ a, b, c, d FROM t1 WHERE (a IN (1, 5) or a IS NULL) AND b in (1, 2) AND d BETWEEN 2 AND 5;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	14
Handler_read_last	0
Handler_read_next	32
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
DROP TABLE t1;
CREATE TABLE t1 (a INT, b INT, c INT, d INT, e INT,
KEY k1(a, b DESC, c, d DESC, e));
INSERT INTO t1 VALUES
(NULL, 1, 1, 3, 4), (NULL, 2, 1, 4, 5),
(1, 2, 1, 3, 4), (2, 2, 1, 4, 5),
(5, 2, 3, 3, 4), (2, 2, 1, 4, 11),
(8, 2, 1, 3, 4), (7, 2, 1, 4, 9);
INSERT INTO t1 SELECT * FROM t1;
INSERT INTO t1 SELECT * FROM t1;
INSERT INTO t1 SELECT * FROM t1;
ANALYZE TABLE t1;
Table	Op	Msg_type	Msg_text
test.t1	analyze	status	OK
set optimizer_switch = 'skip_scan=on';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t1 WHERE (a IN (1, 5) or a IS NULL) AND b in (1, 2) AND d BETWEEN 2 AND 5;
EXPLAIN
-> Filter: (t1.d between 2 and 5)  (rows=3.78)
    -> Covering index range scan on t1 using k1 over (a = NULL AND b = 2) OR (a = NULL AND b = 1) OR (4 more)  (rows=34)

FLUSH STATUS;
SELECT a, b, c, d FROM t1 WHERE (a IN (1, 5) or a IS NULL) AND b in (1, 2) AND d BETWEEN 2 AND 5;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	6
Handler_read_last	0
Handler_read_next	32
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
set optimizer_switch = 'skip_scan=off';
EXPLAIN FORMAT=TREE SELECT a, b, c, d FROM t1 WHERE (a IN (1, 5) or a IS NULL) AND b in (1, 2) AND d BETWEEN 2 AND 5;
EXPLAIN
-> Filter: (t1.d between 2 and 5)  (rows=3.78)
    -> Covering index range scan on t1 using k1 over (a = NULL AND b = 2) OR (a = NULL AND b = 1) OR (4 more)  (rows=34)

FLUSH STATUS;
SELECT a, b, c, d FROM t1 WHERE (a IN (1, 5) or a IS NULL) AND b in (1, 2) AND d BETWEEN 2 AND 5;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	6
Handler_read_last	0
Handler_read_next	32
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.skip_scan, test.no_skip_scan]
EXPLAIN FORMAT=TREE SELECT /*+ SKIP_SCAN(t1) */ a, b, c, d FROM t1 WHERE (a IN (1, 5) or a IS NULL) AND b in (1, 2) AND d BETWEEN 2 AND 5;
EXPLAIN
-> Filter: ((t1.d between 2 and 5) and (t1.b in (1,2)) and ((t1.a in (1,5)) or (t1.a is null)))  (rows=3.78)
    -> Covering index skip scan on t1 using k1 over a IN (NULL, 1, 5), b IN (2, 1), 5 <= d <= 2  (rows=34)

FLUSH STATUS;
SELECT /*+ SKIP_SCAN(t1) */ a, b, c, d FROM t1 WHERE (a IN (1, 5) or a IS NULL) AND b in (1, 2) AND d BETWEEN 2 AND 5;
SHOW STATUS LIKE 'handler_read%';
Variable_name	Value
Handler_read_first	0
Handler_read_key	14
Handler_read_last	0
Handler_read_next	32
Handler_read_prev	0
Handler_read_rnd	0
Handler_read_rnd_next	0
include/diff_tables.inc [test.hint_skip_scan, test.no_skip_scan]
set optimizer_switch = default;
DROP TABLE t1;
#
# Bug#28089360 WL#11322: SIG11 AT QEP_SHARED_OWNER::JOIN | SQL/SQL_OPT_EXEC_SHARED.H:458
#
CREATE TABLE t1 (f1 INT(11), f2 VARCHAR(1), KEY k1 (f2, f1));
Warnings:
Warning	1681	Integer display width is deprecated and will be removed in a future release.
INSERT INTO t1 VALUES (-682212662,'c'), (-1974921822,'C'), (1260604936,'9');
CREATE TABLE t2 (f1 INT(11));
Warnings:
Warning	1681	Integer display width is deprecated and will be removed in a future release.
INSERT INTO t2 VALUES (824388284), (1186821161);
CREATE VIEW v1 AS select f1, f2 from t1;
DELETE FROM t2 WHERE (f1, f1) IN (SELECT f1,f2 FROM v1 WHERE f1 >= 2);
DROP VIEW v1;
DROP TABLE t1, t2;
#
# Bug #29602393 ASSERTION `BITMAP_IS_SET(KEY_INFO->TABLE->READ_SET,
#                                        KEY_INFO->KEY_PART.*FAILED
#
CREATE TABLE t1(f1 INT, f2 VARCHAR(64) NOT NULL, PRIMARY KEY (f1))
PARTITION BY RANGE(f1)
(
PARTITION p1 VALUES LESS THAN (3),
PARTITION p2 VALUES LESS THAN (maxvalue)
);
INSERT INTO t1 VALUES (1, 'abcde'), (2, 'abcde'), (3, 'abcde');
CREATE INDEX idx1 ON t1(f2);
ANALYZE TABLE t1;
Table	Op	Msg_type	Msg_text
test.t1	analyze	status	OK
EXPLAIN FORMAT=tree SELECT /*+ SKIP_SCAN(t1 idx1) */ count(*) FROM t1 WHERE f1 <= 3;
EXPLAIN
-> Aggregate: count(0)  (rows=1)
    -> Covering index skip scan on t1 using idx1 over f1 <= 3  (rows=3)

SELECT /*+ SKIP_SCAN(t1 idx1) */ count(*) FROM t1 WHERE f1 <= 3;
count(*)
3
DROP TABLE t1;
#
# Bug 33251616 - NO_SKIP_SCAN hint disables skip scan for all indexes
#
CREATE TABLE t1(c1 INT, c2 INT, c3 INT, c4 INT);
CREATE UNIQUE INDEX i1_t1 ON t1(c1,c2,c3);
CREATE UNIQUE INDEX i2_t1 ON t1(c1,c2,c4);
INSERT INTO t1 VALUES (1,1,1,1), (1,1,2,2), (1,3,3,3), (1,4,4,4), (1,5,5,5),
(2,1,1,1), (2,2,2,2), (2,3,3,3), (2,4,4,4), (2,5,5,5);
INSERT INTO t1 SELECT c1, c2, c3+20, c4+10  FROM t1;
INSERT INTO t1 SELECT c1, c2, c3+40, c4+20 FROM t1;
INSERT INTO t1 SELECT c1, c2+20, c3, c4+40 FROM t1;
INSERT INTO t1 SELECT c1, c2+40, c3, c4+80 FROM t1;
ANALYZE TABLE t1;
Table	Op	Msg_type	Msg_text
test.t1	analyze	status	OK
EXPLAIN FORMAT=tree SELECT c1, c2 FROM t1 WHERE c2 = 40;
EXPLAIN
-> Covering index skip scan on t1 using i1_t1 over c2 = 40  (rows=6.29)

EXPLAIN FORMAT=tree SELECT /*+NO_SKIP_SCAN(t1 i1_t1)*/ c1, c2 FROM t1 WHERE c2 = 40;
EXPLAIN
-> Covering index skip scan on t1 using i2_t1 over c2 = 40  (rows=6.29)

EXPLAIN FORMAT=tree SELECT /*+NO_SKIP_SCAN(t1 i2_t1)*/ c1, c2 FROM t1 WHERE c2 = 40;
EXPLAIN
-> Covering index skip scan on t1 using i1_t1 over c2 = 40  (rows=6.29)

EXPLAIN FORMAT=tree SELECT /*+NO_SKIP_SCAN(t1)*/  c1, c2 FROM t1 WHERE c2 = 40;
EXPLAIN
-> Filter: (t1.c2 = 40)  (rows=6.29)
    -> Covering index scan on t1 using i1_t1  (rows=160)

EXPLAIN FORMAT=tree SELECT /*+SKIP_SCAN(t1 i2_t1)*/  c1, c2 FROM t1 WHERE c2 = 40;
EXPLAIN
-> Covering index skip scan on t1 using i2_t1 over c2 = 40  (rows=6.29)

SET OPTIMIZER_SWITCH = 'skip_scan=off';
EXPLAIN FORMAT=tree SELECT c1, c2 FROM t1 WHERE c2 = 40;
EXPLAIN
-> Filter: (t1.c2 = 40)  (rows=6.29)
    -> Covering index scan on t1 using i1_t1  (rows=160)

DROP TABLE t1;
SET OPTIMIZER_SWITCH = default;
Skip scan with subqueries
CREATE TABLE `t1` (
`pk` int NOT NULL AUTO_INCREMENT,
`col_int_key` int DEFAULT NULL,
`col_varchar_key` varchar(1) DEFAULT NULL,
PRIMARY KEY (`pk`),
KEY `idx_t1_col_int_key` (`col_int_key`),
KEY `idx_t1_col_varchar_key` (`col_varchar_key`));
CREATE TABLE `t2` (
`pk` int NOT NULL AUTO_INCREMENT,
`col_varchar_key` varchar(1) DEFAULT NULL,
PRIMARY KEY (`pk`),
KEY `idx_t2_col_varchar_key` (`col_varchar_key`));
SELECT SUBQUERY1_t1.col_varchar_key AS SUBQUERY1_field1
FROM t2 AS SUBQUERY1_t1
WHERE (SUBQUERY1_t1.pk > 5 AND
SUBQUERY1_t1.col_varchar_key NOT IN (SELECT CHILD_SUBQUERY1_t1 .col_varchar_key AS CHILD_SUBQUERY1_field1
FROM t1 AS CHILD_SUBQUERY1_t1
WHERE CHILD_SUBQUERY1_t1.col_int_key = 3));
SUBQUERY1_field1
SELECT SUM(table1.pk )AS field1 , COUNT(table2.col_varchar_key ) AS field2
FROM (t1 AS table1 JOIN (t2 AS table2))
WHERE (table2.col_varchar_key <> SOME (SELECT SUBQUERY2_t1. col_varchar_key AS SUBQUERY2_field1
FROM t1 AS SUBQUERY2_t1
WHERE (SUBQUERY2_t1.pk < 4
AND SUBQUERY2_t1. pk IN (SELECT 2 EXCEPT SELECT 9))));
field1	field2
NULL	0
DROP TABLE t1;
DROP TABLE t2;
SET OPTIMIZER_SWITCH = default;
