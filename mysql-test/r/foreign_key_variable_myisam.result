# FR 8.3) innodb_native_foreign_keys must not affect FK handling for other storage
#Â engine tables
# Phase A: OFF (default)
SHOW VARIABLES LIKE 'innodb_native_foreign_keys';
Variable_name	Value
innodb_native_foreign_keys	OFF
CREATE TABLE t1(f1 INT PRIMARY KEY) ENGINE=MyISAM;
CREATE TABLE t2(f1 INT, f2 INT, FOREIGN KEY (f2) REFERENCES t1(f1) ON UPDATE CASCADE ON DELETE CASCADE) ENGINE=MyISAM;
# Insert child pointing to non-existent parent -> should succeed
INSERT INTO t2 VALUES (1, 999);
# Update parent -> no cascade to child
INSERT INTO t1 VALUES (10);
INSERT INTO t2 VALUES (10, 10);
UPDATE t1 SET f1 = 20 WHERE f1 = 10;
# Delete parent -> no cascade
DELETE FROM t1 WHERE f1 = 20;
SELECT * FROM t1;
f1
SELECT * FROM t2;
f1	f2
1	999
10	10
# MyISAM ignores FK metadata
SHOW CREATE TABLE t2;
Table	Create Table
t2	CREATE TABLE `t2` (
  `f1` int DEFAULT NULL,
  `f2` int DEFAULT NULL,
  KEY `f2` (`f2`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
# Phase B: ON
# restart: --innodb_native_foreign_keys=ON
SHOW VARIABLES LIKE 'innodb_native_foreign_keys';
Variable_name	Value
innodb_native_foreign_keys	ON
DROP TABLE IF EXISTS t1, t2;
CREATE TABLE t1(f1 INT PRIMARY KEY) ENGINE=MyISAM;
CREATE TABLE t2(f1 INT, f2 INT, FOREIGN KEY (f2) REFERENCES t1(f1) ON UPDATE CASCADE ON DELETE CASCADE) ENGINE=MyISAM;
# Insert child pointing to non-existent parent -> should succeed
INSERT INTO t2 VALUES (1, 999);
# Update parent -> no cascade to child
INSERT INTO t1 VALUES (10);
INSERT INTO t2 VALUES (10, 10);
UPDATE t1 SET f1 = 20 WHERE f1 = 10;
# Delete parent -> no cascade
DELETE FROM t1 WHERE f1 = 20;
SELECT * FROM t1;
f1
SELECT * FROM t2;
f1	f2
1	999
10	10
# MyISAM ignores FK metadata
SHOW CREATE TABLE t2;
Table	Create Table
t2	CREATE TABLE `t2` (
  `f1` int DEFAULT NULL,
  `f2` int DEFAULT NULL,
  KEY `f2` (`f2`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
DROP TABLE t1, t2;
