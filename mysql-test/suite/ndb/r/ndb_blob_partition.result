drop table if exists t1;
create table t1 (
a int not null,
b text not null,
c int not null,
d blob,
e int not null,
primary key (a, c),
unique key (c, e)
)
engine=ndb
partition by range (c)
partitions 3
( partition p1 values less than (2),
partition p2 values less than (3),
partition p3 values less than (4));
Warnings:
Warning	6035	'PARTITION BY RANGE' for 'ndbcluster' storage engine is deprecated and will be removed in a future release.
insert into t1 values (1, @x1, 1, @x2, 1);
insert into t1 values (1, @y1, 2, @y2, 1);
insert into t1 values (1, @z1, 3, @z2, 1);
insert into t1 values (2, @x1, 1, @x2, 2);
insert into t1 values (2, @y1, 2, @y2, 2);
insert into t1 values (2, @z1, 3, @z2, 2);
insert into t1 values (3, @x1, 1, @x2, 3);
insert into t1 values (3, @y1, 2, @y2, 3);
insert into t1 values (3, @z1, 3, @z2, 3);
select a, c, sha2(b,256), sha2(d,256) from t1 order by a, c;
a	c	sha2(b,256)	sha2(d,256)
1	1	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
1	2	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
1	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
2	1	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
2	2	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
2	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
3	1	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
3	2	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
3	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
select a, c, sha2(b,256), sha2(d,256) from t1 where a = 1 and c = 1;
a	c	sha2(b,256)	sha2(d,256)
1	1	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
select a, c, sha2(b,256), sha2(d,256) from t1 where a = 1 and c = 2;
a	c	sha2(b,256)	sha2(d,256)
1	2	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
select a, c, sha2(b,256), sha2(d,256) from t1 where a = 1 and c = 3;
a	c	sha2(b,256)	sha2(d,256)
1	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
update t1 set b = @y1, d = @y2 where a = 2 and c = 1;
update t1 set b = @z1, d = @z2 where a = 2 and c = 2;
update t1 set b = @x1, d = @x2 where a = 2 and c = 3;
select a, c, sha2(b,256), sha2(d,256) from t1 order by a, c;
a	c	sha2(b,256)	sha2(d,256)
1	1	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
1	2	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
1	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
2	1	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
2	2	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
2	3	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
3	1	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
3	2	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
3	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
update t1 set b = @y1, d = @y2 where c = 1 and e = 3;
update t1 set b = @z1, d = @z2 where c = 2 and e = 3;
update t1 set b = @x1, d = @x2 where c = 3 and e = 3;
select a, c, sha2(b,256), sha2(d,256) from t1 order by a, c;
a	c	sha2(b,256)	sha2(d,256)
1	1	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
1	2	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
1	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
2	1	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
2	2	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
2	3	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
3	1	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
3	2	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
3	3	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
update t1 set b = @x1, d = @x2;
select a, c, sha2(b,256), sha2(d,256) from t1 order by a, c;
a	c	sha2(b,256)	sha2(d,256)
1	1	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
1	2	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
1	3	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
2	1	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
2	2	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
2	3	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
3	1	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
3	2	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
3	3	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
update t1 set b = @x1, d = @x2 where c = 1;
update t1 set b = @y1, d = @y2 where c = 2;
update t1 set b = @z1, d = @z2 where c = 3;
select a, c, sha2(b,256), sha2(d,256) from t1 order by a, c;
a	c	sha2(b,256)	sha2(d,256)
1	1	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
1	2	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
1	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
2	1	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
2	2	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
2	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
3	1	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
3	2	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
3	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
delete from t1 where a = 1 and c = 1;
select a, c, sha2(b,256), sha2(d,256) from t1 order by a, c;
a	c	sha2(b,256)	sha2(d,256)
1	2	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
1	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
2	1	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
2	2	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
2	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
3	1	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
3	2	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
3	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
delete from t1 where c = 2 and e = 2;
select a, c, sha2(b,256), sha2(d,256) from t1 order by a, c;
a	c	sha2(b,256)	sha2(d,256)
1	2	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
1	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
2	1	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
2	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
3	1	97b5bd6896b4c8515996a10ef1813b365931fa6f3299c94c9ac9cac4215d62b9	856a620e42995c67505568f5291213a2f2adfd5d4ef418c1fcbb26da79af3f30
3	2	78aa2873fe5bc99babaa639347f74c9d9bfc6ec669a43054b98ceca74cf63b0d	8bc55c3c7476bb2b056505b695334c2d824ba92e1aca32e3ce70a1159c19a8a8
3	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
delete from t1 where c < 3;
select a, c, sha2(b,256), sha2(d,256) from t1 order by a, c;
a	c	sha2(b,256)	sha2(d,256)
1	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
2	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
3	3	e748dc69e9aa79e072be1391ee2e065a6f015badf1a275000617ddbf8edebdc1	e7646b96518da2489eb6b7e234ee3144379f436b9399b119d34c83c0b118bdc0
delete from t1;
select a, c, sha2(b,256), sha2(d,256) from t1 order by a, c;
a	c	sha2(b,256)	sha2(d,256)
drop table t1;
create table t1 (
a char(4),
b int,
primary key (a, b)
)
engine=ndb
character set latin1
partition by key (a)
partitions 4;
insert into t1 values ('aaa',1);
insert into t1 values ('bbb',1);
insert into t1 values ('bbb',2);
select count(*) from t1 where a = 'aaa';
count(*)
1
select count(*) from t1 where a = 'Aaa';
count(*)
1
select count(*) from t1 where a = 'aAa';
count(*)
1
select count(*) from t1 where a = 'aaA';
count(*)
1
select count(*) from t1 where a = 'AAa';
count(*)
1
select count(*) from t1 where a = 'AaA';
count(*)
1
select count(*) from t1 where a = 'aAA';
count(*)
1
select count(*) from t1 where a = 'AAA';
count(*)
1
drop table t1;
create table t1 (
a varbinary(10),
b int,
primary key (a, b)
)
engine=ndb
character set latin1
partition by key (a)
partitions 4;
insert into t1 values ('aaa',1);
insert into t1 values ('aaabbb',1);
insert into t1 values ('aaabbb',2);
insert into t1 values ('aaabbbccc',1);
insert into t1 values ('aaabbbccc',2);
insert into t1 values ('aaabbbccc',3);
select count(*) from t1 where a = 'aaa';
count(*)
1
select count(*) from t1 where a = 'Aaa';
count(*)
0
select count(*) from t1 where a = 'aaabbb';
count(*)
2
select count(*) from t1 where a = 'aaaBbb';
count(*)
0
select count(*) from t1 where a = 'aaabbbccc';
count(*)
3
select count(*) from t1 where a = 'aaabbbCcc';
count(*)
0
drop table t1;
