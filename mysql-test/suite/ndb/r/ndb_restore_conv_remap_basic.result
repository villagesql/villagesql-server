create table t1 (kbu bigint unsigned,
kbs bigint,
dbu_low bigint unsigned,
dbu_hi bigint unsigned,
dbs_low bigint,
dbs_hi bigint,
d int,
t text,
primary key(kbu, kbs))
engine = ndb;
insert into t1 values 
(10, 10, 0, 18446744073709551606, -9223372036854775808, 9223372036854775798, 10, repeat("10", 1000)),
(11, 11, 1, 18446744073709551607, -9223372036854775807, 9223372036854775799, 11, repeat("11", 1000)),
(12, 12, 2, 18446744073709551608, -9223372036854775806, 9223372036854775800, 12, repeat("12", 1000)),
(13, 13, 3, 18446744073709551609, -9223372036854775805, 9223372036854775801, 13, repeat("13", 1000)),
(14, 14, 4, 18446744073709551610, -9223372036854775804, 9223372036854775802, 14, repeat("14", 1000)),
(15, 15, 5, 18446744073709551611, -9223372036854775803, 9223372036854775803, 15, repeat("15", 1000)),
(16, 16, 6, 18446744073709551612, -9223372036854775802, 9223372036854775804, 16, repeat("16", 1000)),
(17, 17, 7, 18446744073709551613, -9223372036854775801, 9223372036854775805, 17, repeat("17", 1000)),
(18, 18, 8, 18446744073709551614, -9223372036854775800, 9223372036854775806, 18, repeat("18", 1000)),
(19, 19, 9, 18446744073709551615, -9223372036854775799, 9223372036854775807, 19, repeat("19", 1000));
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha2(t,256) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha2(t,256)
10	10	0	18446744073709551606	-9223372036854775808	9223372036854775798	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
11	11	1	18446744073709551607	-9223372036854775807	9223372036854775799	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
12	12	2	18446744073709551608	-9223372036854775806	9223372036854775800	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
13	13	3	18446744073709551609	-9223372036854775805	9223372036854775801	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
14	14	4	18446744073709551610	-9223372036854775804	9223372036854775802	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
15	15	5	18446744073709551611	-9223372036854775803	9223372036854775803	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
16	16	6	18446744073709551612	-9223372036854775802	9223372036854775804	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
17	17	7	18446744073709551613	-9223372036854775801	9223372036854775805	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
18	18	8	18446744073709551614	-9223372036854775800	9223372036854775806	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
19	19	9	18446744073709551615	-9223372036854775799	9223372036854775807	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
Create a table with NULL-value columns
create table t2(
col1 int unsigned not null primary key,
col2 int unsigned DEFAULT NULL)
charset = utf8mb4 engine=ndbcluster;
insert into t2 values(1, 1), (2,2), (3,NULL), (4,4), (5,5);
Run backup
Restore with no key offsets + 0 + 0
Remapping a column having NULL values with an offset.
NULL values will be preserved.
truncate test.t1;
truncate table t2;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha2(t,256) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha2(t,256)
10	10	0	18446744073709551606	-9223372036854775808	9223372036854775798	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
11	11	1	18446744073709551607	-9223372036854775807	9223372036854775799	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
12	12	2	18446744073709551608	-9223372036854775806	9223372036854775800	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
13	13	3	18446744073709551609	-9223372036854775805	9223372036854775801	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
14	14	4	18446744073709551610	-9223372036854775804	9223372036854775802	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
15	15	5	18446744073709551611	-9223372036854775803	9223372036854775803	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
16	16	6	18446744073709551612	-9223372036854775802	9223372036854775804	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
17	17	7	18446744073709551613	-9223372036854775801	9223372036854775805	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
18	18	8	18446744073709551614	-9223372036854775800	9223372036854775806	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
19	19	9	18446744073709551615	-9223372036854775799	9223372036854775807	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
select * from t2 order by col1;
col1	col2
1	11
2	12
3	NULL
4	14
5	15
Restore with small overlapping key offset + 5
truncate test.t1;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha2(t,256) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha2(t,256)
15	15	0	18446744073709551606	-9223372036854775808	9223372036854775798	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
16	16	1	18446744073709551607	-9223372036854775807	9223372036854775799	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
17	17	2	18446744073709551608	-9223372036854775806	9223372036854775800	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
18	18	3	18446744073709551609	-9223372036854775805	9223372036854775801	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
19	19	4	18446744073709551610	-9223372036854775804	9223372036854775802	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
20	20	5	18446744073709551611	-9223372036854775803	9223372036854775803	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
21	21	6	18446744073709551612	-9223372036854775802	9223372036854775804	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
22	22	7	18446744073709551613	-9223372036854775801	9223372036854775805	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
23	23	8	18446744073709551614	-9223372036854775800	9223372036854775806	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
24	24	9	18446744073709551615	-9223372036854775799	9223372036854775807	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
Restore with larger gap key offset + 20
truncate test.t1;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha2(t,256) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha2(t,256)
30	30	0	18446744073709551606	-9223372036854775808	9223372036854775798	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
31	31	1	18446744073709551607	-9223372036854775807	9223372036854775799	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
32	32	2	18446744073709551608	-9223372036854775806	9223372036854775800	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
33	33	3	18446744073709551609	-9223372036854775805	9223372036854775801	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
34	34	4	18446744073709551610	-9223372036854775804	9223372036854775802	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
35	35	5	18446744073709551611	-9223372036854775803	9223372036854775803	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
36	36	6	18446744073709551612	-9223372036854775802	9223372036854775804	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
37	37	7	18446744073709551613	-9223372036854775801	9223372036854775805	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
38	38	8	18446744073709551614	-9223372036854775800	9223372036854775806	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
39	39	9	18446744073709551615	-9223372036854775799	9223372036854775807	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
Restore with low data values + max offset (9223372036854775807)
truncate test.t1;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha2(t,256) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha2(t,256)
10	10	9223372036854775807	18446744073709551606	-1	9223372036854775798	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
11	11	9223372036854775808	18446744073709551607	0	9223372036854775799	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
12	12	9223372036854775809	18446744073709551608	1	9223372036854775800	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
13	13	9223372036854775810	18446744073709551609	2	9223372036854775801	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
14	14	9223372036854775811	18446744073709551610	3	9223372036854775802	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
15	15	9223372036854775812	18446744073709551611	4	9223372036854775803	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
16	16	9223372036854775813	18446744073709551612	5	9223372036854775804	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
17	17	9223372036854775814	18446744073709551613	6	9223372036854775805	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
18	18	9223372036854775815	18446744073709551614	7	9223372036854775806	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
19	19	9223372036854775816	18446744073709551615	8	9223372036854775807	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
Restore with key offset + 30 and low data offset + 110
truncate test.t1;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha2(t,256) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha2(t,256)
40	40	110	18446744073709551606	-9223372036854775698	9223372036854775798	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
41	41	111	18446744073709551607	-9223372036854775697	9223372036854775799	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
42	42	112	18446744073709551608	-9223372036854775696	9223372036854775800	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
43	43	113	18446744073709551609	-9223372036854775695	9223372036854775801	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
44	44	114	18446744073709551610	-9223372036854775694	9223372036854775802	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
45	45	115	18446744073709551611	-9223372036854775693	9223372036854775803	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
46	46	116	18446744073709551612	-9223372036854775692	9223372036854775804	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
47	47	117	18446744073709551613	-9223372036854775691	9223372036854775805	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
48	48	118	18446744073709551614	-9223372036854775690	9223372036854775806	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
49	49	119	18446744073709551615	-9223372036854775689	9223372036854775807	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
Restore with high data values - max offset (-9223372036854775808)
truncate test.t1;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha2(t,256) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha2(t,256)
10	10	0	9223372036854775798	-9223372036854775808	-10	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
11	11	1	9223372036854775799	-9223372036854775807	-9	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
12	12	2	9223372036854775800	-9223372036854775806	-8	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
13	13	3	9223372036854775801	-9223372036854775805	-7	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
14	14	4	9223372036854775802	-9223372036854775804	-6	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
15	15	5	9223372036854775803	-9223372036854775803	-5	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
16	16	6	9223372036854775804	-9223372036854775802	-4	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
17	17	7	9223372036854775805	-9223372036854775801	-3	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
18	18	8	9223372036854775806	-9223372036854775800	-2	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
19	19	9	9223372036854775807	-9223372036854775799	-1	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
Restore with key offset - 10
truncate test.t1;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha2(t,256) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha2(t,256)
0	0	0	18446744073709551606	-9223372036854775808	9223372036854775798	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
1	1	1	18446744073709551607	-9223372036854775807	9223372036854775799	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
2	2	2	18446744073709551608	-9223372036854775806	9223372036854775800	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
3	3	3	18446744073709551609	-9223372036854775805	9223372036854775801	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
4	4	4	18446744073709551610	-9223372036854775804	9223372036854775802	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
5	5	5	18446744073709551611	-9223372036854775803	9223372036854775803	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
6	6	6	18446744073709551612	-9223372036854775802	9223372036854775804	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
7	7	7	18446744073709551613	-9223372036854775801	9223372036854775805	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
8	8	8	18446744073709551614	-9223372036854775800	9223372036854775806	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
9	9	9	18446744073709551615	-9223372036854775799	9223372036854775807	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
Restore with max positive key offset kbu + 9223372036854775807 kbs + 9223372036854775807-19
truncate test.t1;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha2(t,256) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha2(t,256)
9223372036854775817	9223372036854775798	0	18446744073709551606	-9223372036854775808	9223372036854775798	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
9223372036854775818	9223372036854775799	1	18446744073709551607	-9223372036854775807	9223372036854775799	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
9223372036854775819	9223372036854775800	2	18446744073709551608	-9223372036854775806	9223372036854775800	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
9223372036854775820	9223372036854775801	3	18446744073709551609	-9223372036854775805	9223372036854775801	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
9223372036854775821	9223372036854775802	4	18446744073709551610	-9223372036854775804	9223372036854775802	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
9223372036854775822	9223372036854775803	5	18446744073709551611	-9223372036854775803	9223372036854775803	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
9223372036854775823	9223372036854775804	6	18446744073709551612	-9223372036854775802	9223372036854775804	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
9223372036854775824	9223372036854775805	7	18446744073709551613	-9223372036854775801	9223372036854775805	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
9223372036854775825	9223372036854775806	8	18446744073709551614	-9223372036854775800	9223372036854775806	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
9223372036854775826	9223372036854775807	9	18446744073709551615	-9223372036854775799	9223372036854775807	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
Restore with max negative key offset kbu -10 kbs -9223372036854775808
truncate test.t1;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha2(t,256) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha2(t,256)
0	-9223372036854775798	0	18446744073709551606	-9223372036854775808	9223372036854775798	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
1	-9223372036854775797	1	18446744073709551607	-9223372036854775807	9223372036854775799	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
2	-9223372036854775796	2	18446744073709551608	-9223372036854775806	9223372036854775800	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
3	-9223372036854775795	3	18446744073709551609	-9223372036854775805	9223372036854775801	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
4	-9223372036854775794	4	18446744073709551610	-9223372036854775804	9223372036854775802	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
5	-9223372036854775793	5	18446744073709551611	-9223372036854775803	9223372036854775803	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
6	-9223372036854775792	6	18446744073709551612	-9223372036854775802	9223372036854775804	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
7	-9223372036854775791	7	18446744073709551613	-9223372036854775801	9223372036854775805	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
8	-9223372036854775790	8	18446744073709551614	-9223372036854775800	9223372036854775806	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
9	-9223372036854775789	9	18446744073709551615	-9223372036854775799	9223372036854775807	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
drop table test.t1;
drop table test.t2;
create table t1 (kiu int unsigned,
kis int,
diu_low int unsigned,
diu_hi int unsigned,
dis_low int,
dis_hi int,
d int,
t text,
primary key(kiu, kis))
engine = ndb;
insert into t1 values 
(10, 10, 0, 4294967286, -2147483648, 2147483638, 10, repeat("10", 1000)),
(11, 11, 1, 4294967287, -2147483647, 2147483639, 11, repeat("11", 1000)),
(12, 12, 2, 4294967288, -2147483646, 2147483640, 12, repeat("12", 1000)),
(13, 13, 3, 4294967289, -2147483645, 2147483641, 13, repeat("13", 1000)),
(14, 14, 4, 4294967290, -2147483644, 2147483642, 14, repeat("14", 1000)),
(15, 15, 5, 4294967291, -2147483643, 2147483643, 15, repeat("15", 1000)),
(16, 16, 6, 4294967292, -2147483642, 2147483644, 16, repeat("16", 1000)),
(17, 17, 7, 4294967293, -2147483641, 2147483645, 17, repeat("17", 1000)),
(18, 18, 8, 4294967294, -2147483640, 2147483646, 18, repeat("18", 1000)),
(19, 19, 9, 4294967295, -2147483639, 2147483647, 19, repeat("19", 1000));
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha2(t,256) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha2(t,256)
10	10	0	4294967286	-2147483648	2147483638	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
11	11	1	4294967287	-2147483647	2147483639	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
12	12	2	4294967288	-2147483646	2147483640	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
13	13	3	4294967289	-2147483645	2147483641	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
14	14	4	4294967290	-2147483644	2147483642	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
15	15	5	4294967291	-2147483643	2147483643	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
16	16	6	4294967292	-2147483642	2147483644	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
17	17	7	4294967293	-2147483641	2147483645	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
18	18	8	4294967294	-2147483640	2147483646	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
19	19	9	4294967295	-2147483639	2147483647	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
Run backup
Restore with no key offsets + 0 + 0
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha2(t,256) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha2(t,256)
10	10	0	4294967286	-2147483648	2147483638	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
11	11	1	4294967287	-2147483647	2147483639	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
12	12	2	4294967288	-2147483646	2147483640	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
13	13	3	4294967289	-2147483645	2147483641	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
14	14	4	4294967290	-2147483644	2147483642	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
15	15	5	4294967291	-2147483643	2147483643	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
16	16	6	4294967292	-2147483642	2147483644	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
17	17	7	4294967293	-2147483641	2147483645	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
18	18	8	4294967294	-2147483640	2147483646	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
19	19	9	4294967295	-2147483639	2147483647	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
Restore with small overlapping key offset + 5
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha2(t,256) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha2(t,256)
15	15	0	4294967286	-2147483648	2147483638	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
16	16	1	4294967287	-2147483647	2147483639	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
17	17	2	4294967288	-2147483646	2147483640	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
18	18	3	4294967289	-2147483645	2147483641	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
19	19	4	4294967290	-2147483644	2147483642	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
20	20	5	4294967291	-2147483643	2147483643	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
21	21	6	4294967292	-2147483642	2147483644	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
22	22	7	4294967293	-2147483641	2147483645	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
23	23	8	4294967294	-2147483640	2147483646	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
24	24	9	4294967295	-2147483639	2147483647	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
Restore with larger gap key offset + 20
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha2(t,256) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha2(t,256)
30	30	0	4294967286	-2147483648	2147483638	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
31	31	1	4294967287	-2147483647	2147483639	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
32	32	2	4294967288	-2147483646	2147483640	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
33	33	3	4294967289	-2147483645	2147483641	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
34	34	4	4294967290	-2147483644	2147483642	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
35	35	5	4294967291	-2147483643	2147483643	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
36	36	6	4294967292	-2147483642	2147483644	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
37	37	7	4294967293	-2147483641	2147483645	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
38	38	8	4294967294	-2147483640	2147483646	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
39	39	9	4294967295	-2147483639	2147483647	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
Restore with low data values + max offset (2147483647)
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha2(t,256) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha2(t,256)
10	10	2147483647	4294967286	-1	2147483638	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
11	11	2147483648	4294967287	0	2147483639	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
12	12	2147483649	4294967288	1	2147483640	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
13	13	2147483650	4294967289	2	2147483641	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
14	14	2147483651	4294967290	3	2147483642	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
15	15	2147483652	4294967291	4	2147483643	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
16	16	2147483653	4294967292	5	2147483644	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
17	17	2147483654	4294967293	6	2147483645	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
18	18	2147483655	4294967294	7	2147483646	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
19	19	2147483656	4294967295	8	2147483647	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
Restore with key offset + 30 and low data offset + 110
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha2(t,256) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha2(t,256)
40	40	110	4294967286	-2147483538	2147483638	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
41	41	111	4294967287	-2147483537	2147483639	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
42	42	112	4294967288	-2147483536	2147483640	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
43	43	113	4294967289	-2147483535	2147483641	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
44	44	114	4294967290	-2147483534	2147483642	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
45	45	115	4294967291	-2147483533	2147483643	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
46	46	116	4294967292	-2147483532	2147483644	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
47	47	117	4294967293	-2147483531	2147483645	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
48	48	118	4294967294	-2147483530	2147483646	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
49	49	119	4294967295	-2147483529	2147483647	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
Restore with high data values - max offset (-2147483648)
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha2(t,256) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha2(t,256)
10	10	0	2147483638	-2147483648	-10	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
11	11	1	2147483639	-2147483647	-9	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
12	12	2	2147483640	-2147483646	-8	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
13	13	3	2147483641	-2147483645	-7	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
14	14	4	2147483642	-2147483644	-6	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
15	15	5	2147483643	-2147483643	-5	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
16	16	6	2147483644	-2147483642	-4	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
17	17	7	2147483645	-2147483641	-3	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
18	18	8	2147483646	-2147483640	-2	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
19	19	9	2147483647	-2147483639	-1	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
Restore with key offset - 10
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha2(t,256) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha2(t,256)
0	0	0	4294967286	-2147483648	2147483638	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
1	1	1	4294967287	-2147483647	2147483639	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
2	2	2	4294967288	-2147483646	2147483640	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
3	3	3	4294967289	-2147483645	2147483641	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
4	4	4	4294967290	-2147483644	2147483642	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
5	5	5	4294967291	-2147483643	2147483643	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
6	6	6	4294967292	-2147483642	2147483644	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
7	7	7	4294967293	-2147483641	2147483645	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
8	8	8	4294967294	-2147483640	2147483646	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
9	9	9	4294967295	-2147483639	2147483647	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
Restore with max positive key offset kiu + 2147483647 kis + 2147483647-19
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha2(t,256) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha2(t,256)
2147483657	2147483638	0	4294967286	-2147483648	2147483638	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
2147483658	2147483639	1	4294967287	-2147483647	2147483639	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
2147483659	2147483640	2	4294967288	-2147483646	2147483640	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
2147483660	2147483641	3	4294967289	-2147483645	2147483641	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
2147483661	2147483642	4	4294967290	-2147483644	2147483642	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
2147483662	2147483643	5	4294967291	-2147483643	2147483643	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
2147483663	2147483644	6	4294967292	-2147483642	2147483644	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
2147483664	2147483645	7	4294967293	-2147483641	2147483645	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
2147483665	2147483646	8	4294967294	-2147483640	2147483646	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
2147483666	2147483647	9	4294967295	-2147483639	2147483647	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
Restore with max negative key offset kiu -10 kis -2147483648
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha2(t,256) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha2(t,256)
0	-2147483638	0	4294967286	-2147483648	2147483638	10	ee9da8347a3af2a1307b17f3e5bdc13ca171c3410202e80a20ebd264717289aa
1	-2147483637	1	4294967287	-2147483647	2147483639	11	b4ef1b0dc85167c3fea916b5b99d3a0c622129d920e74bf81b5bc19036fa4d39
2	-2147483636	2	4294967288	-2147483646	2147483640	12	2c5710adb57f55c3dce8f85b9eea38b43e5fbb5d03bd901857e4bd7d9c7d8771
3	-2147483635	3	4294967289	-2147483645	2147483641	13	fe28419dd0e0e8b6d71ef54dec8ae7643c9d74bcef35e827144b832c2428d70c
4	-2147483634	4	4294967290	-2147483644	2147483642	14	099f1ba3ab0f6f62b3a2dd7e0ef66a426746c3fa5a281dfccc6976bd37fd9246
5	-2147483633	5	4294967291	-2147483643	2147483643	15	4c8d6c058ff7e32d0728cb5862bd57b21f53c8066c012b9548b6963249126e21
6	-2147483632	6	4294967292	-2147483642	2147483644	16	f624ea16056829e802bf0784e91b0b15afc4ba963637bb3d3261d3eaf69c7436
7	-2147483631	7	4294967293	-2147483641	2147483645	17	256f89313fab094565cbc2c23d1285d42dd24cdb75d639eab71b5c42ecb0765e
8	-2147483630	8	4294967294	-2147483640	2147483646	18	25cfb40c53b18303d8c5f365675902877f31abaf50c5e2db1446d7c82fd99b6c
9	-2147483629	9	4294967295	-2147483639	2147483647	19	27385aa328b175811c5012b44fa15405b4ef54d2fa9bb9f2b76b271c263948a2
drop table test.t1;
